<html layout:decorate="~{layout/layout.html}">
    <body>
        <section layout:fragment="content">
            <h1>join</h1>

            <!-- 메인 폼 -->
            <form th:action="@{/member/join}"
                  method="post"
                  onsubmit="checkForm(this); return false;"
                  th:object="${memberForm}"
                  class="flex flex-col gap-2">
                <div class="flex flex-col">
                    <label for="username">아이디</label>
                    <div class="flex">
                        <input type="text"
                               th:field="*{username}"
                               placeholder="아아디"
                               oninput="document.getElementById('checkUsername').value = this.value"
                               class="input"/>

                        <!-- 아이디 중복 확인용 -->
                        <button type="submit" form="checkUsernameForm" class="btn ml-2 mr-2">중복 확인</button>
                        <div th:if="${isValid != null}">
                            <div th:if="${isValid}"
                                 class="flex items-center justify-center bg-[#00aa0055] border h-10 w-16">가능</div>
                            <div th:unless="${isValid}"
                                 class="flex items-center justify-center bg-[#aa000055] border h-10 w-16">불가능</div>
                        </div>
                    </div>
                </div>
                <div th:replace="~{error/error :: username}"></div>
                <div class="flex flex-col">
                    <label for="password">비밀번호</label>
                    <input type="password"
                           th:field="*{password}"
                           placeholder="비밀번호"
                           class="input"/>
                </div>
                <div th:replace="~{error/error :: password}"></div>
                <div class="flex flex-col">
                    <label for="passwordConfirm">비밀번호 확인</label>
                    <input type="password"
                           th:field="*{passwordConfirm}"
                           placeholder="비밀번호 확인"
                           class="input"/>
                </div>
                <div th:replace="~{error/error :: passwordConfirm}"></div>
                <div>
                    <button type="submit" class="btn">제출</button>
                </div>
            </form>

            <!-- 아이디 중복 확인용 폼 -->
            <form th:action="@{/member/checkUsername}"
                  method="post"
                  id="checkUsernameForm"
                  onsubmit="checkForm(this); return false;"
                  th:object="${memberForm}">
                <input hidden
                       type="text"
                       name="username"
                       id="checkUsername"
                       th:value="*{username}"
                       oninput="document.getElementById('username').value = this.value">
            </form>

            <script>
                function checkForm(form)
                {
                    // 공백 처리
                    form.username.value = form.username.value.trim();
                    form.password.value = form.password.value.trim();
                    form.passwordConfirm.value = form.passwordConfirm.value.trim();

                    form.submit();
                }
            </script>
        </section>
    </body>
</html>